(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))o(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&o(a)}).observe(document,{childList:!0,subtree:!0});function n(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerPolicy&&(s.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?s.credentials="include":r.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function o(r){if(r.ep)return;r.ep=!0;const s=n(r);fetch(r.href,s)}})();const Q=(t,e,n)=>()=>{W(t,e,n)},D=(t,e="value")=>{pt(t)||c(t,e,"an instance of HTMLElement")},g=t=>P(t)==="",B=t=>typeof t=="string",z=t=>B(t)?t:"",P=t=>z(t).trim(),Z=t=>U(t).slice(8,-1),U=t=>Object.prototype.toString.call(t),tt=(t,e=80)=>{let n;if(typeof t=="bigint")n=t.toString()+"n";else if(t instanceof WeakMap||t instanceof WeakSet||t instanceof Map||t instanceof Set||t instanceof Promise)n=String(t);else try{n=JSON.stringify(t)}catch{n=String(t)}return n===void 0&&(n=String(t)),n.length>e?n.slice(0,e)+"…":n},et=t=>(d(t,"raw"),JSON.parse(t)),nt=(t,e=null)=>{try{return et(t)}catch(n){return console.error("parseJSONWithFallback: Failed to parse JSON. Raw value:",t,n),e}},ot=t=>t==null,rt=t=>typeof t=="boolean",l=(t,e="value")=>{At(t)||c(t,e,"an instance of Element")};function st(t,e){if(t=T(t),e=T(e),!Xt(t,e))throw new Error(`Cannot nest <${e}> inside <${t}> — this is prohibited by the rules.`)}const x=(t,e="value")=>{Mt(t,e)||c(t,e,"an HTMLElement that supports textContent")},i=t=>{if(d(t,"HTML class name"),g(t))throw new SyntaxError("Class name cannot be empty.");if(/\s/.test(t))throw new SyntaxError(`Class name must not contain spaces: "${t}"`);if(!/^-?[_\p{L}][_\p{L}\p{N}-]*$/u.test(t))throw new SyntaxError(`Invalid class name: "${t}". A valid class name must be a non-empty string without spaces, start with a letter, underscore (_), or hyphen (-), and contain only letters, digits, hyphens (-), and underscores (_). Examples: "header", "_hidden", "-dark-theme", "menu_item-1", "привет", "按钮".`)},_=(t,e)=>{l(t,"first argument"),dt(e)},at=t=>{if(!zt(t))throw new Error(`"${t}" is not a valid ARIA role for a DOM element (HTMLElement, SVGElement, or MathMLElement)`)},F=(t,{mode:e="ignore"}={})=>{if(d(t,"HTML id"),g(t))throw new SyntaxError("ID cannot be empty.");if(/\s/.test(t))throw new SyntaxError(`ID must not contain spaces: "${t}"`);if(!/^-?[_\p{L}][_\p{L}\p{N}-]*$/u.test(t))throw new SyntaxError(`Invalid id: "${t}". A valid id must be a non-empty string without spaces. Recommended format (CSS-safe): start with a letter, underscore (_), or hyphen (-), and contain only letters, digits, hyphens (-), and underscores (_). Examples: "header", "_root", "-section1", "todo_item-1", "привет", "按钮".`);if(typeof document>"u")return;const r={ignore:()=>{},unique:()=>{if(document.getElementById(t))throw new SyntaxError(`ID must be unique: "${t}" already exists in the document.`)},mustExist:()=>{if(!document.getElementById(t))throw new Error(`No element with id "${t}" exists in the document.`)}}[e];if(!r)throw new SyntaxError(`Invalid mode "${e}". Expected "ignore" | "unique" | "mustExist".`);r()},V=(t,e="value")=>{Ut(t)||c(t,e,"a DOM element of type <ul>")},H=(t,e="value")=>{xt(t)||c(t,e,"a DOM element of type <li>")},ct=(t,e="value")=>{jt(t)||c(t,e,"a DOM element of type <div>")},it=(t,e="value")=>{Gt(t)||c(t,e,"a DOM element of type <button>")},lt=t=>{if(!R.includes(t))throw new TypeError(`Invalid <button> type: "${t}". Must be one of: ${R.join(", ")}`)},ut=t=>{if(!N.includes(t))throw new TypeError(`Invalid <input> type: "${t}". Must be one of: ${N.join(", ")}`)},S=(t,e="value")=>{Ht(t)||c(t,e,"a DOM element of type <input>")},v=(t,e="value")=>{re(t)||c(t,e,"an instance of Event")},dt=t=>{if(d(t),g(t))throw new SyntaxError("CSS Selector cannot be an empty string.");try{document.createElement("div").querySelector(t)}catch(e){throw new SyntaxError(`Invalid CSS selector: "${t}". ${e.message}`)}},d=(t,e="value")=>{B(t)||c(t,e,"string")},mt=(t,e="value",n="a non-null and non-undefined value")=>{t==null&&c(t,e,n)},I=(t,e)=>{const n=e||"value";if(d(t,n),t.trim()==="")throw new Error(`${n} must be a non-empty string, but an empty string was provided`)},Et=(t,e="value")=>{typeof t!="function"&&c(t,e,"a function")},Tt=(t,e="value")=>{rt(t)||c(t,e,"a boolean")},c=(t,e,n)=>{const o=U(t),r=Z(t),s=tt(t);throw new TypeError(`Expected ${e} to be ${n}, but received ${o} of type ${r} with value ${s}`)},ft=(t,e="localStorage")=>{t!==globalThis.localStorage&&c(t,e,"globalThis.localStorage")},gt=t=>{if(!(()=>{try{const n="__test__";return t.setItem(n,"1"),t.removeItem(n),!0}catch{return!1}})())throw new Error("globalThis.localStorage is present but not usable at runtime — possibly due to browser restrictions (e.g., Safari private mode, quota exceeded, or disabled access).")},St=t=>{ft(t),gt(t)},p=t=>{d(t);const e=document.querySelector(t);return l(e),e},It=(t,e)=>{l(t,"First argument 'root' must be a valid DOM Element."),i(e);const n=t.getElementsByClassName(e)[0];if(!n)throw new TypeError(`No element found with class name '${e}'`);return n},E=(t,e)=>(st(t,e),t.appendChild(e)),pt=t=>t instanceof HTMLElement,ht=t=>Zt.has(T(t)),Lt=t=>te.has(T(t)),At=t=>t instanceof Element,$=(t,e)=>{l(t,"first argument"),i(e),t.className=e},wt=(t,e)=>{l(t,"first argument"),i(e),t.classList.toggle(e)},bt=(t,e)=>{l(t,"first argument"),i(e),t.classList.add(e)},Ot={class:"className",for:"htmlFor",maxlength:"maxLength",readonly:"readOnly",tabindex:"tabIndex",selected:"selected"},Ct=(t,e,n,o={})=>{const{assertElement:r=!0}=o;if(r&&l(t),!t||typeof t.setAttribute!="function")return t;const s=Ot[e]??e;if(ee.includes(e)){const a=!!n;s in t&&(t[s]=a),Object.defineProperty(t,e,{get(){return a},configurable:!0,enumerable:!0}),a?t.setAttribute(e,e):t.removeAttribute(e)}else if(ne.includes(e)){const a=String(n);t.setAttribute(e,a),s in t&&(t[s]=a),Object.defineProperty(t,e,{get(){return a},set(u){const m=String(u);t.setAttribute(e,m),s in t&&(t[s]=m)},configurable:!0,enumerable:!0})}else if(oe.includes(e)){const a=Number(n);t.setAttribute(e,String(a)),s in t&&(t[s]=a),Object.defineProperty(t,e,{get(){return a},set(u){const m=Number(u);t.setAttribute(e,String(m)),s in t&&(t[s]=m)},configurable:!0,enumerable:!0})}else{const a=String(n);t.setAttribute(e,a),Object.defineProperty(t,e,{get(){return a},set(u){const m=String(u);t.setAttribute(e,m)},configurable:!0,enumerable:!0})}return t},yt=(t,e={})=>(l(t),Object.entries(e).forEach(([n,o])=>{Ct(t,n,o,{assertElement:!1})}),t),b=(t,e)=>{x(t,"first argument"),d(e,"second argument"),t.textContent=e},Mt=(t,e="value")=>(D(t,e),!(Lt(t)||ht(t))),Rt=t=>(x(t),t.textContent),T=t=>(D(t,"first argument"),t.tagName),Nt=(t,e)=>(_(t,e),t.closest(e)),h=(t,e)=>{const n=j(e);return _(t,n),t.closest(n)},Dt=(t,e)=>{l(t,"first argument"),at(e),t.setAttribute("role",e)},Bt=(t,e)=>{l(t,"First argument of setAriaLabel (DOM element: HTMLElement, SVGElement, MathMLElement)"),I(e,"Second argument of setAriaLabel (aria-label value, must be a non-empty string)"),t.setAttribute("aria-label",e)},Pt=()=>document.createElement("li"),Ut=t=>t instanceof HTMLUListElement,xt=t=>t instanceof HTMLLIElement,G=(t,e)=>{V(t,"first argument"),H(e,"second argument"),E(t,e)},_t=(t,e)=>{H(t,"first argument"),i(e),$(t,e)},Ft=t=>{S(t),t.value=""},L=t=>{S(t),t.value="",t.focus()},Vt=t=>(S(t),t.value),k=t=>P(Vt(t)),Ht=t=>t instanceof HTMLInputElement,vt=(t="text")=>{ut(t);const e=document.createElement("input");return e.type=t,e},$t=({id:t,className:e,checked:n=!1})=>{const o=vt("checkbox");return i(e),F(t),Tt(n,`property "checked" of <input type="checkbox" id="${t}" class="${e}">`),yt(o,{id:t,class:e,checked:n}),o},Gt=t=>t instanceof HTMLButtonElement,kt=(t="submit")=>{lt(t);const e=document.createElement("button");return e.type=t,e},jt=t=>t instanceof HTMLDivElement,Kt=({htmlFor:t,text:e,className:n})=>{F(t),I(e,"crcreateLabelForInputext content"),i(n);const o=document.createElement("label");return o.htmlFor=t,o.textContent=e,o.className=n,o},j=t=>(i(t),`.${t}`),M={UL:new Set(["Flow content","Metadata content"]),OL:new Set(["Flow content","Metadata content"]),DL:new Set(["Flow content"]),SELECT:new Set(["Phrasing content","Metadata content"]),TABLE:new Set(["Flow content"]),THEAD:new Set(["Flow content"]),TBODY:new Set(["Flow content"]),TFOOT:new Set(["Flow content"]),COLGROUP:new Set(["Metadata content"]),TR:new Set(["Flow content"]),HEAD:new Set(["Metadata content"]),OPTGROUP:new Set(["Phrasing content"]),A:new Set(["Phrasing content"]),BUTTON:new Set(["Phrasing content"]),P:new Set(["Phrasing content"]),LI:new Set(["Flow content","Phrasing content"]),DIV:new Set(["Flow content"]),SECTION:new Set(["Flow content"]),ARTICLE:new Set(["Flow content"]),NAV:new Set(["Flow content"]),HEADER:new Set(["Flow content"]),FOOTER:new Set(["Flow content"]),ASIDE:new Set(["Flow content"]),MAIN:new Set(["Flow content"]),BLOCKQUOTE:new Set(["Flow content"]),SPAN:new Set(["Phrasing content"]),EM:new Set(["Phrasing content"]),STRONG:new Set(["Phrasing content"]),SMALL:new Set(["Phrasing content"]),MARK:new Set(["Phrasing content"]),SUB:new Set(["Phrasing content"]),SUP:new Set(["Phrasing content"])},Jt={A:new Set(["A"]),BUTTON:new Set(["BUTTON"]),LABEL:new Set(["LABEL"]),FORM:new Set(["FORM"]),P:new Set(["DIV","SECTION","ARTICLE","HEADER","FOOTER","NAV","ASIDE","MAIN","TABLE","UL","OL","FORM"])},Wt={"Metadata content":["BASE","LINK","META","NOSCRIPT","SCRIPT","STYLE","TEMPLATE","TITLE"],"Flow content":["DIV","P","UL","OL","LI","SECTION","ARTICLE","ASIDE","NAV","HEADER","FOOTER","MAIN","TABLE","FORM","FIGURE","FIGCAPTION","HR","BLOCKQUOTE","PRE"],"Sectioning content":["ARTICLE","ASIDE","NAV","SECTION"],"Heading content":["H1","H2","H3","H4","H5","H6","HGROUP"],"Phrasing content":["A","ABBR","AREA","AUDIO","B","BDI","BDO","BR","BUTTON","CANVAS","CITE","CODE","DATA","DATALIST","DEL","DFN","EM","EMBED","I","IFRAME","IMG","INPUT","INS","KBD","LABEL","MAP","MARK","MATH","METER","NOSCRIPT","OBJECT","OUTPUT","PICTURE","PROGRESS","Q","RUBY","S","SAMP","SCRIPT","SELECT","SMALL","SPAN","STRONG","SUB","SUP","SVG","TEMPLATE","TEXTAREA","TIME","U","VAR","VIDEO","WBR"],"Embedded content":["AUDIO","CANVAS","EMBED","IFRAME","IMG","MATH","OBJECT","PICTURE","SVG","VIDEO","SOURCE","TRACK"],"Interactive content":["A","AUDIO","BUTTON","DETAILS","EMBED","IFRAME","INPUT","LABEL","SELECT","TEXTAREA","VIDEO"]},qt=(()=>{const t={};for(const[e,n]of Object.entries(Wt))for(const o of n)t[o]||(t[o]=new Set),t[o].add(e);return t})(),Yt=["LI","SCRIPT","TEMPLATE"],Xt=(t,e)=>{const n=t.toUpperCase(),o=e.toUpperCase(),r=Jt[n];if(r&&r.has(o)||(n==="UL"||n==="OL")&&!Yt.includes(o))return!1;if(!M[n])return!0;const s=M[n],a=qt[o];if(!a)return!0;for(const u of a)if(s.has(u))return!0;return!1},Qt=new Set(["button","checkbox","gridcell","link","menuitem","menuitemcheckbox","menuitemradio","option","progressbar","radio","scrollbar","searchbox","separator","slider","spinbutton","switch","tab","tabpanel","textbox","treeitem","combobox","grid","listbox","menu","menubar","radiogroup","tablist","tree","treegrid","application","article","cell","columnheader","definition","directory","document","feed","figure","group","heading","img","list","listitem","math","none","note","presentation","row","rowgroup","rowheader","separator","table","term","toolbar","tooltip","banner","complementary","contentinfo","form","main","navigation","region","search","alert","log","marquee","status","timer","alertdialog","dialog","select","selectmenu","combobox","grid","listbox","menubar","radiogroup","tablist","treegrid"]),zt=t=>(d(t),Qt.has(t)),Zt=new Set(["VIDEO","AUDIO","PICTURE","CANVAS"]),te=new Set(["AREA","BASE","BR","COL","EMBED","HR","IMG","INPUT","LINK","META","PARAM","SOURCE","TRACK","WBR"]),R=["button","submit","reset"],N=["text","password","email","number","tel","url","search","checkbox","radio","file","hidden","submit","reset","button","date","datetime-local","month","week","time","color","range"],ee=["checked","disabled","readonly","selected"],ne=["id","class","name","value","title","placeholder"],oe=["tabindex","maxlength","min","max","step"],re=t=>t instanceof Event,K=t=>(v(t),t.target),se=t=>(v(t),t.currentTarget),ae=t=>{let e=K(t);return e.nodeType===Node.TEXT_NODE&&(e=e.parentElement),e},ce=(t,e,n)=>{const o=ae(t),r=h(o,Y());if(r){const s=h(r,f());s&&(s.remove(),w(A(e)),L(n));return}if(o.matches(".todo__check")){if(h(o,f())){const{target:a,className:u}=Oe(t);Te(a,u)}w(A(e)),L(n)}},ie=t=>()=>{ye(t)},le=(t,e,n)=>o=>{o.key==="Enter"&&(o.preventDefault(),W(t,e,n))};function ue(t,e){const{type:n,todos:o}=t;n==="update"&&(e.innerHTML="",q(e,o))}const de=(t,e)=>{Ee(t,e),Ft(e)},me=t=>{const e=k(t);return!g(e)},Ee=(t,e)=>{const n=k(e),o=J(n);G(t,o);const r=A(t);w(r)},Te=(t,e)=>{wt(t,e)},fe=({text:t,checked:e})=>{const n=J(t,e);return e&&bt(n,C()),n},ge=(t,e)=>(St(t),d(e,"key"),t.getItem(e)),Se=(t,e,n)=>{const o=ge(t,e);return nt(o,n)},O={todo:"todoList"};function Ie(t){return I(t,"broadcastChannelName (name for BroadcastChannel API)"),new BroadcastChannel(t)}function pe(){return mt(crypto,"Wep API crypto"),Et(crypto.randomUUID,"crypto.randomUUID"),crypto.randomUUID()}const he=()=>`taskId-${pe()}`,J=(t,e=!1)=>{const n=f(),o=Ae(n),r=he();return E(o,we({id:r,checked:e})),E(o,be({htmlFor:r,text:t})),E(o,Le(t)),o},Le=t=>{I(t,"createTodoRemoveButton: task");const e=kt("button");return $(e,Y()),b(e,"×"),Bt(e,`Delete task: ${t}`),Dt(e,"button"),e},Ae=t=>{const e=Pt();return _t(e,t),e},we=({id:t,checked:e=!1})=>{const n=Ve();return $t({id:t,className:n,checked:e})},be=({htmlFor:t,text:e})=>{const n=X();return Kt({htmlFor:t,text:e,className:n})},Oe=t=>({className:C(),target:Nt(K(t),j(f())),currentTarget:se(t)}),Ce=(t,e)=>b(t,e),ye=t=>b(t,""),W=(t,e,n)=>{me(t)?de(e,t):Ce(n,"Task cannot be empty"),L(t)},A=t=>Array.from(t.children,e=>({text:Rt(It(e,X())),checked:e.matches(`.${C()}`)})),q=(t,e)=>{e.forEach(n=>G(t,fe(n)))},Me={todoButton:"[data-js-todo-btn-add]",todoInput:"[data-js-todo-new-task-input]",todoList:"[data-js-todo-list]",todoValidMessage:"[data-js-todo-error-empty-task]"},Re=t=>{const e=p(t);return it(e),e},Ne=t=>{const e=p(t);return S(e),e},De=t=>{const e=p(t);return V(e),e},Be=t=>{const e=p(t);return ct(e),e},{todoButton:Pe,todoInput:Ue,todoList:xe,todoValidMessage:_e}=Me,Fe=()=>({todoButton:Re(Pe),todoInput:Ne(Ue),todoList:De(xe),todoValidMessage:Be(_e)}),f=()=>{const t="todo__item";return i(t),t},C=()=>{const t="todo__item--checked";return i(t),t},Y=()=>{const t="todo__remove";return i(t),t},X=()=>{const t="todo__text";return i(t),t},Ve=()=>{const t="todo__check";return i(t),t},He=()=>{const t=[],e=Se(localStorage,O.todo,t);return Array.isArray(e)?e:t},w=t=>{try{localStorage.setItem(O.todo,JSON.stringify(t)),y().postMessage({type:"update",todos:t})}catch(e){console.error("Failed to save todos:",e)}},ve=()=>{const t=[],e=O.todo;if(ot(localStorage.getItem(e)))try{localStorage.setItem(e,JSON.stringify(t)),y().postMessage({type:"update",DefaultTodos:t})}catch(n){console.error("Failed to initialize todos:",n)}};function y(){return Ie("todos_channel")}const $e=()=>{const{todoButton:t,todoInput:e,todoList:n,todoValidMessage:o}=Fe(),r=y();ve(),r.addEventListener("message",a=>{ue(a.data,n)});const s=He();q(n,s),t.addEventListener("click",Q(e,n,o)),n.addEventListener("click",a=>{ce(a,n,e)}),e.addEventListener("keydown",le(e,n,o)),e.addEventListener("input",ie(o))};window.addEventListener("DOMContentLoaded",$e,{once:!0});
